# ğŸ“Š Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ±ÑŠÑÑĞ½ĞµĞ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ middleware

## Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ğ»Ğ¾ (Ğ”Ğ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET / HTTP/1.1                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsageMiddleware.dispatch()                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ try:                                                â”‚
â”‚   response = await call_next(request)               â”‚
â”‚   status_code = response.status_code                â”‚
â”‚   return response  â† Ğ’ĞĞ—Ğ’Ğ ĞĞ©ĞĞ•Ğ¢ (1)                 â”‚
â”‚                                                      â”‚
â”‚ except Exception:                                   â”‚
â”‚   raise                                             â”‚
â”‚                                                      â”‚
â”‚ finally:                     â† Ğ’Ğ«ĞŸĞĞ›ĞĞ¯Ğ•Ğ¢Ğ¡Ğ¯ ĞŸĞĞ¡Ğ›Ğ•!   â”‚
â”‚   path = request.url.path                           â”‚
â”‚   if path.startswith("/"):                          â”‚
â”‚     return  â† ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ˜Ğ¡Ğ«Ğ’ĞĞ•Ğ¢ (2)!                   â”‚
â”‚                             â†“                       â”‚
â”‚                         Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ None! âŒ         â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        Middleware Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ None
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Middleware Stack                                    â”‚
â”‚                                                     â”‚
â”‚ await response(scope, receive, send)                â”‚
â”‚        â†‘                                            â”‚
â”‚     None! (ĞĞµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ None)                  â”‚
â”‚     TypeError: 'NoneType' object is not callable    â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
           500 ERROR! ğŸ’¥
```

---

## Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ (ĞŸĞĞ¡Ğ›Ğ•)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET / HTTP/1.1                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsageMiddleware.dispatch()                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ try:                                                â”‚
â”‚   response = await call_next(request)               â”‚
â”‚   status_code = response.status_code                â”‚
â”‚   (Ğ½Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼!) â† Ğ–Ğ”ĞĞœ finally                   â”‚
â”‚                                                      â”‚
â”‚ except Exception:                                   â”‚
â”‚   raise                                             â”‚
â”‚                                                      â”‚
â”‚ finally:                     â† Ğ’Ğ«ĞŸĞĞ›ĞĞ¯Ğ•Ğ¢Ğ¡Ğ¯          â”‚
â”‚   path = request.url.path                           â”‚
â”‚   if path.startswith("/"):                          â”‚
â”‚     pass  â† ĞĞ• Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ None! âœ…                  â”‚
â”‚   else:                                             â”‚
â”‚     (Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)                                   â”‚
â”‚     pass  â† ĞĞ• Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ None! âœ…                  â”‚
â”‚                                                      â”‚
â”‚ return response  â† ĞĞ”Ğ˜Ğ return Ğ² ĞºĞ¾Ğ½Ñ†Ğµ! âœ…           â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
    Middleware Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Response âœ…
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Middleware Stack                                    â”‚
â”‚                                                     â”‚
â”‚ await response(scope, receive, send)                â”‚
â”‚        â†‘                                            â”‚
â”‚     Response object (ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±ÑŠĞµĞºÑ‚)            â”‚
â”‚     Response Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ÑÑ Ğ´Ğ°Ğ»ÑŒÑˆĞµ                      â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
          200 OK! âœ…
```

---

## ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ Python: Finally Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ ĞŸĞĞ¡Ğ›Ğ• return!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ def example():                                   â”‚
â”‚                                                  â”‚
â”‚   try:                                           â”‚
â”‚     return "FROM TRY"                            â”‚
â”‚                                                  â”‚
â”‚   finally:                                       â”‚
â”‚     return "FROM FINALLY"  â† ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ˜Ğ¡Ğ«Ğ’ĞĞ•Ğ¢!    â”‚
â”‚                                                  â”‚
â”‚ result = example()                               â”‚
â”‚ print(result)  # "FROM FINALLY" (Ğ½Ğµ FROM TRY!)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:
1. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ try Ğ±Ğ»Ğ¾Ğº
2. Ğ’ÑÑ‚Ñ€ĞµÑ‚Ğ¸Ñ‚ÑŒ return
3. ĞŸĞĞ”.Ğ–Ğ”Ğ.Ğ¢Ğ¬
4. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ finally Ğ±Ğ»Ğ¾Ğº
5. Ğ’ÑÑ‚Ñ€ĞµÑ‚Ğ¸Ñ‚ÑŒ return - ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ˜Ğ¡ĞĞ¢Ğ¬!
6. Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¸Ğ· finally
```

---

## ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ vs ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞ¯ (Ğ‘Ğ«Ğ› ĞšĞĞ”)                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                    â•‘
â•‘ async def dispatch(request, call_next):            â•‘
â•‘   try:                                             â•‘
â•‘     response = await call_next(request)            â•‘
â•‘     return response  â† return Ğ² try                â•‘
â•‘                                                    â•‘
â•‘   except Exception:                                â•‘
â•‘     raise                                          â•‘
â•‘                                                    â•‘
â•‘   finally:                                         â•‘
â•‘     if condition:                                  â•‘
â•‘       return  â† return Ğ² finally                   â•‘
â•‘     ...                                            â•‘
â•‘     return  â† return Ğ² finally                     â•‘
â•‘     ...                                            â•‘
â•‘     return  â† return Ğ² finally                     â•‘
â•‘                                                    â•‘
â•‘ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢: Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ None Ğ¸Ğ· finally! âŒ         â•‘
â•‘                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞ¯ (ĞĞĞ’Ğ«Ğ™ ĞšĞĞ”)               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                    â•‘
â•‘ async def dispatch(request, call_next):            â•‘
â•‘   try:                                             â•‘
â•‘     response = await call_next(request)            â•‘
â•‘     (Ğ½Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼) â† Ğ¶Ğ´Ñ‘Ğ¼ finally               â•‘
â•‘                                                    â•‘
â•‘   except Exception:                                â•‘
â•‘     raise                                          â•‘
â•‘                                                    â•‘
â•‘   finally:                                         â•‘
â•‘     if condition:                                  â•‘
â•‘       pass  â† pass Ğ²Ğ¼ĞµÑÑ‚Ğ¾ return                  â•‘
â•‘     ...                                            â•‘
â•‘     pass  â† pass Ğ²Ğ¼ĞµÑÑ‚Ğ¾ return                    â•‘
â•‘     ...                                            â•‘
â•‘     pass  â† pass Ğ²Ğ¼ĞµÑÑ‚Ğ¾ return                    â•‘
â•‘                                                    â•‘
â•‘   return response  â† Ğ¾Ğ´Ğ¸Ğ½ return Ğ² ĞºĞ¾Ğ½Ñ†Ğµ! âœ…       â•‘
â•‘                                                    â•‘
â•‘ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢: Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Response Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾! âœ…      â•‘
â•‘                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² Ğ»Ğ¾Ğ³Ğ°Ñ…

```
ERROR: Exception in ASGI application
  TypeError: 'NoneType' object is not callable

  File "/starlette/middleware/base.py", line 192, in __call__
    await response(scope, wrapped_receive, send)
           â†‘
        None! (middleware returned None)

TypeError: 'NoneType' object is not callable
         â†‘
      ĞŸÑ‹Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ²Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ None ĞºĞ°Ğº Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ!
```

**ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸:**
```
Middleware Ğ²ĞµÑ€Ğ½ÑƒĞ» None
Middleware stack Ğ¿Ñ‹Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ²Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ None ĞºĞ°Ğº response Ğ¾Ğ±ÑŠĞµĞºÑ‚
ĞĞ¾ None Ğ½Ğµ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ callable (Ğ½Ğµ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼Ñ‹Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ¼)
ĞÑˆĞ¸Ğ±ĞºĞ°: TypeError
```

---

## Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

```
Ğ”Ğ:  return Ğ² try â†’ return Ğ² finally Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ â†’ None
ĞŸĞĞ¡Ğ›Ğ•: return Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ· Ğ² ĞºĞ¾Ğ½Ñ†Ğµ â†’ Response

Ğ”Ğ:  response = None â†’ finally return None â†’ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
ĞŸĞĞ¡Ğ›Ğ•: response = Response â†’ finally pass â†’ return Response â†’ OK
```

---

## ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚

```python
# ĞŸĞĞœĞĞ˜Ğ¢Ğ•:
# finally Ğ±Ğ»Ğ¾Ğº Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ¿Ğ¾ÑĞ»Ğµ try!
# Ğ•ÑĞ»Ğ¸ finally Ğ¸Ğ¼ĞµĞµÑ‚ return - Ğ¾Ğ½ ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ˜Ğ¡Ğ«Ğ’ĞĞ•Ğ¢ return Ğ¸Ğ· try!
# Ğ­Ñ‚Ğ¾ Ğ½Ğµ Ğ±Ğ°Ğ³ Python - ÑÑ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ!

# ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ:
# 1. Ğ’ try Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ return Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
# 2. Ğ’ finally ĞĞ• Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ return (ĞµÑĞ»Ğ¸ Ğ² try Ğ±Ñ‹Ğ» return)
# 3. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ finally Ğ´Ğ»Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¸ (cleanup)
# 4. return Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞĞ”Ğ˜Ğ Ñ€Ğ°Ğ· Ğ² ĞºĞ¾Ğ½Ñ†Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
```

---

## Ğ”Ğ¾ Ğ¸ ĞŸĞ¾ÑĞ»Ğµ Ğ² ĞºĞ¾Ğ´Ğµ

### Ğ‘Ñ‹Ğ»Ğ¾ (Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾):
```python
def dispatch(...):
    response = None
    try:
        response = await call_next(request)
        return response  # â† (1) Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚
    finally:
        if condition:
            return  # â† (2) ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚! Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ None!
```

### Ğ¡Ñ‚Ğ°Ğ»Ğ¾ (Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾):
```python
def dispatch(...):
    response = None
    try:
        response = await call_next(request)
        # â† (1) ĞĞµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼, Ğ¶Ğ´Ñ‘Ğ¼ finally
    finally:
        if condition:
            pass  # â† (2) pass Ğ²Ğ¼ĞµÑÑ‚Ğ¾ return
    
    return response  # â† (3) ĞĞ´Ğ¸Ğ½ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ² ĞºĞ¾Ğ½Ñ†Ğµ!
```

---

## Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

**ĞÑˆĞ¸Ğ±ĞºĞ°:** Finally Ğ±Ğ»Ğ¾Ğº Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ» return Ğ¸Ğ· try Ğ±Ğ»Ğ¾ĞºĞ°  
**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Middleware Ğ²ĞµÑ€Ğ½ÑƒĞ» None  
**Ğ¡Ğ»ĞµĞ´ÑÑ‚Ğ²Ğ¸Ğµ:** TypeError - 'NoneType' object is not callable  
**Ğ­Ñ„Ñ„ĞµĞºÑ‚:** 500 Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ  

**Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:** ĞŸĞµÑ€ĞµÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ return â†’ finally return â†’ return Ğ² ĞºĞ¾Ğ½Ñ†Ğµ  
**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Middleware Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Response Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾  
**Ğ­Ñ„Ñ„ĞµĞºÑ‚:** Ğ’ÑÑ‘ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚! âœ…

---

**ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ:** If finally has return, it overwrites the try return!
